sql_lib : From lib:sql

test_query : Template sql_lib.offline_query {
	tables : [ { sql_from : "XXX" } ]
	columns : {
		a : expr.extract {
			field : year
			arg : expr.now {}
		}
	}
}

sql_stmts : {
	mysql : "SELECT EXTRACT(YEAR FROM UTC_TIMESTAMP()) AS a FROM XXX"
	postgresql : "SELECT EXTRACT(YEAR FROM (now() at time zone 'utc')) AS a FROM XXX"
	sqlite : "SELECT CAST(strftime('%Y', datetime('now', 'utc')) AS INTEGER) AS a FROM XXX"
}

value : For provider : sql_lib.sql_providers, stmt : sql_stmts
	Reduce acc && (stmt Is Null || test_query(provider : provider) == stmt)
	With acc : True
